% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dbUpsertDataPostgres.R
\name{dbUpsertDataPostgres}
\alias{dbUpsertDataPostgres}
\title{Upsert Data to PostgreSQL with ON CONFLICT and Chunking}
\usage{
dbUpsertDataPostgres(
  conn,
  new.data,
  schema.name,
  table.name,
  key.cols,
  timestamp.col,
  keep = "last",
  chunk.size = 10000L,
  check.schema = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{conn}{A valid SQL Server connection object (from \pkg{DBI}).}

\item{new.data}{A non-empty `data.frame` with new data to upsert.}

\item{schema.name}{Character string naming the target schema (default: `"dbo"`).}

\item{table.name}{Character string naming the target table.}

\item{key.cols}{Character vector of column names forming the primary key.}

\item{timestamp.col}{Character scalar, the column used for conflict resolution.}

\item{keep}{`"first"` or `"last"`; whether to keep the earliest or latest record
on timestamp conflicts. Default is `"last"`.}

\item{chunk.size}{Integer, number of rows per insert chunk. Default is `10000`.}

\item{check.schema}{Logical; whether to validate schema compatibility. Default is `TRUE`.}

\item{verbose}{Logical; whether to print progress messages. Default is `TRUE`.}
}
\value{
A `data.frame` transaction log.
}
\description{
Efficiently upserts large data frames into a PostgreSQL table using
`INSERT ... ON CONFLICT`. If the target table does not exist, it is
created. Conflicts on key columns are resolved by comparing timestamps,
keeping either the earliest or latest record.
}
